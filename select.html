<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<script src="http://code.jquery.com/jquery-1.11.2.min.js"></script>
	<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
	<title>Selections</title>
	<style>
		div{ border: 1px solid red; padding: 10px; }
		p{ border: 1px solid blue; padding: 10px; }
	</style>
</head>
<body onload="init()">
	<div><small>selections:</small><br /></div>
	<p><small>history:</small><br /></p>
	<button>generate random selection</button>
	
<script type="text/javascript">
		
var selection = {
	arr1: [ {id:0, type:0, name:"running"},
		{id:1, type:0, name:"boxing"},
		{id:2, type:0, name:"burpee"},
		{id:3, type:0, name:"yoga"},
		{id:4, type:0, name:"dancing"}],
	arr2: [ {id:5, type:1, name:"coffee"},
		{id:6, type:1, name:"music"},
		{id:7, type:1, name:"juice"}],
	arr3: [],
	temp: false,
	generate:function(callback)
	{	
		var arr1 = this.arr1, arr2 = this.arr2, arr3 = this.arr3;
		
		if (!this.temp){
			this.temp = arr1.shuffle().slice(0).slice(0, 3);
		}
		else
		{
			if (arr1.length >= 2 && arr2.length >= 1) {
				this.temp = arr1.shuffle().slice(0).slice(0, 2);
				this.temp.push(arr2[Math.floor(Math.random() * arr2.length)]);
			}
			else{
				arr3 = arr1.concat(arr2);
				this.temp = arr3.shuffle().slice(0).slice(0, 3);
			}
		}
		callback(this.temp.length > 1 ? this.temp : this.temp[0]);
	},
	subtract: function(str)
	{
		var arr1 = this.arr1, arr2 = this.arr2,
		    obj = str.split("|"),
		    array = obj[0] == 0 ? arr1 : arr2;
		
		for (var i=0; i<array.length; ++i)
			if (array[i].id == obj[1])
				array.splice(i, 1);
	}
}


function generateRandom()
{
	// yeni secenekler almak icin cagri yontemi
	selection.generate(function(array){
	
		if (array.length > 1) {
			$("div").append("<br />------<br />");
			for (var i=0; i<array.length; ++i) {		
				$("div").append('<a href="javascript:playselection('+"'"+ array[i].type +"|"+ array[i].id + "'"+')">'+ array[i].name +'</a> ');
			}
		}
		else{
			$("div").append('<br />------<br />play '+ array.name +' directly.')
		}	
		
	});
}
	
function playselection(str)
{
	// seceneklere tiklandigi zaman bu sekilde bir geri besleme gerekiyor.
	selection.subtract(str);		
	$("p").append(str.split("|")[1] + "<br />");
}
	
function init()
{
	$("button").click(generateRandom);
}
	
Array.prototype.shuffle=function(){
	var len = this.length,tmp,i
	while(len){
		i=Math.random()*len-- |0;
		tmp=this[len],this[len]=this[i],this[i]=tmp;
	}
	return this;
}
</script>
</body>
</html>
